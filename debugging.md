# Debugging Tips

Debugging information can be generated by the toolchain by adding the `-debug -m` option, with these options:

* sdcc .cdb files are generated
* sccz80 generates .cdb information encoded into the .map file

z88dk-ticks supports parsing the encoded cdb information and provides limited debugging information (PC to address file translation). The generated information contains information on variable types, offsets etc, but at present this isn't utilised.

To enable source level debugging in an emulator, an emulator needs to:

1. Parse plain .cdb files (as generated by zsdcc) to obtain variable information
2. Parse the .cdb information contained with the .map file (generated by sccz80) to obtain variable information
3. Parse the .map file to obtain symbol address, section information (generated by z80asm)
4. Parse the .map file to extract source code line information (`__C_LINE`, `__ASM_LINE` symbols) (generated by z80asm, sccz80)


## C language

When debugging it is useful to compile to the .asm file using `--c-code-in-asm -a` and using that as a reference as to what the generated code is doing.

Using a debugger on an appropriate emulator in combination with the .map (-m) files generated by the compiler can be surprisingly successful. In particular if you can isolate an algorithm then the tracing and breakpoint tools within the ticks emulator can quickly diagnose issues.

## Hunting assembly code or compiler bugs

The [debug library](library/debug) features some runtime inspection tool, to inspect the stack content at a certain time, display a block of data directly on the device or a full disassembly of a code portion.

On the external side, when cross-compiling, consider that the zcc -v shows any single step of the compilation process. The temporary files are automatically deleted, but by supplying the appropriate options (-E, -a) to stop the processing at a point in time.

